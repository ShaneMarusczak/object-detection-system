# Sample Configuration: Traffic Line with Email Notifications
# ==============================================================================
# This configuration shows how to send email alerts when vehicles cross
# the traffic boundary line configured in the base config.yaml
#
# Based on your current setup with ROI and traffic boundary line.
# ==============================================================================

# ==============================================================================
# DETECTION SETTINGS
# ==============================================================================
detection:
  model_file: "yolo11n.pt"
  track_classes: [2, 3, 5, 7]  # car, motorcycle, bus, truck
  confidence_threshold: 0.25


# ==============================================================================
# REGION OF INTEREST (ROI) CROPPING
# ==============================================================================
roi:
  horizontal:
    enabled: true
    crop_from_left_pct: 0
    crop_to_right_pct: 45

  vertical:
    enabled: true
    crop_from_top_pct: 5
    crop_to_bottom_pct: 95


# ==============================================================================
# COUNTING LINES
# ==============================================================================
# Traffic boundary line with email notification enabled
lines:
  - type: vertical
    position_pct: 25
    description: "traffic boundary"
    allowed_classes: [2, 3, 5, 7]
    notify_email: true                       # ← Enable email for this line
    cooldown_minutes: 5                      # Send email at most once per 5 minutes
    message: "Vehicle crossed traffic boundary"  # Custom notification message


# ==============================================================================
# SPEED CALCULATION
# ==============================================================================
speed_calculation:
  enabled: false


# ==============================================================================
# FRAME SAVING
# ==============================================================================
frame_saving:
  enabled: false

temp_frames_enabled: false  # Disable temp frames if not using frame capture


# ==============================================================================
# OUTPUT SETTINGS
# ==============================================================================
output:
  json_dir: "data"


# ==============================================================================
# CONSOLE OUTPUT
# ==============================================================================
console_output:
  enabled: true
  level: "detailed"  # Use "summary" or "silent" for less output


# ==============================================================================
# EVENT CONSUMERS
# ==============================================================================
consumers:
  json_writer:
    enabled: true
    prompt_save: true

  # Enable per-event email notifications
  email_notifier:
    enabled: true  # ← Must be true to send emails for tagged lines/zones

  # Optional: Also send periodic digest emails
  email_digest:
    enabled: false
    period_minutes: 60
    period_label: "Last Hour"


# ==============================================================================
# NOTIFICATIONS
# ==============================================================================
# Email configuration - REQUIRED for email_notifier to work
notifications:
  enabled: true  # ← Must be true

  email:
    enabled: true  # ← Must be true

    # SMTP Server Settings
    smtp_server: "smtp.gmail.com"        # For Gmail
    smtp_port: 587
    use_tls: true

    # Credentials
    # For Gmail: Use an app-specific password
    # Generate at: https://myaccount.google.com/apppasswords
    username: "your-email@gmail.com"     # ← REPLACE with your email
    password: "your-app-password"        # ← REPLACE with app password

    # Sender and Recipients
    from_address: "your-email@gmail.com" # ← REPLACE with your email
    to_addresses:
      - "your-email@gmail.com"           # ← REPLACE with recipient(s)

# ==============================================================================
# OTHER EMAIL PROVIDERS
# ==============================================================================
#
# Outlook/Office 365:
#   smtp_server: "smtp-mail.outlook.com"
#   smtp_port: 587
#
# AWS SES (Example for us-east-1):
#   smtp_server: "email-smtp.us-east-1.amazonaws.com"
#   smtp_port: 587
#   username: "your-ses-smtp-username"
#   password: "your-ses-smtp-password"


# ==============================================================================
# CAMERA SETTINGS
# ==============================================================================
camera:
  url: "http://192.168.86.33:4747/video"


# ==============================================================================
# RUNTIME SETTINGS
# ==============================================================================
runtime:
  default_duration_hours: 1.0
  queue_size: 1000
  analyzer_startup_delay: 1
  detector_shutdown_timeout: 5
  analyzer_shutdown_timeout: 10


# ==============================================================================
# HOW TO USE THIS CONFIG
# ==============================================================================
#
# 1. Update email settings (lines 73-81) with your credentials
#
# 2. Run with this config:
#    python -m object_detection.main --config config-traffic-email-sample.yaml
#
# 3. What happens:
#    - When a vehicle (car, motorcycle, bus, truck) crosses the vertical line
#      at 25% from the left edge
#    - An email is sent immediately with event details
#    - Emails are rate-limited by cooldown_minutes (5 minutes in this example)
#
# 4. Expected email content:
#    Subject: "Object Detection Alert: traffic boundary"
#    Body:
#      Vehicle crossed traffic boundary
#
#      Event Details:
#      Time: 2025-12-22T15:30:45.123Z
#      Type: LINE_CROSS
#      Object: car
#      Line: traffic boundary
#      Direction: LTR (or RTL)
#
# ==============================================================================
